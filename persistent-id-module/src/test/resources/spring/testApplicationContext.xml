<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.1.xsd"
    default-lazy-init="true">

	<context:component-scan base-package="gov.hawaii.digitalarchives.hida.persistentid" />
	
	<bean id="loggerBean" class="org.springbyexample.util.log.AnnotationLoggerBeanPostProcessor" />

	<bean id="dbhome" class="java.nio.file.Paths" factory-method="get">
		<constructor-arg index="0">
			<value type="java.lang.String">webapps/web-ingest-application/WEB-INF/pid/</value>
		</constructor-arg>
		<constructor-arg index="1">
			<list></list>
		</constructor-arg>
	</bean>
	
	<beans profile="basicFactory">
		<bean class="gov.hawaii.digitalarchives.hida.persistentid.Hark$HarkFactory$ArkFactory">
			<constructor-arg type="java.lang.String" value=".ze" />
			<constructor-arg type="java.lang.String" value="70111" />
			<constructor-arg type="java.nio.file.Path" ref="dbhome" />
		</bean>
		
	  	<bean class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean">
			<property name="serviceLocatorInterface" value="gov.hawaii.digitalarchives.hida.persistentid.PersistentIdBuilderLocator"></property>
		</bean>
		
		<bean id="basicFactory" class="gov.hawaii.digitalarchives.hida.persistentid.DefaultPersistentIdFactory">
			<property name="scheme" value="#{T(gov.hawaii.digitalarchives.hida.persistentid.Ark).SCHEME}" />
		</bean>
		
		<bean id="badSchemaFactory" class="gov.hawaii.digitalarchives.hida.persistentid.DefaultPersistentIdFactory">
			<property name="scheme" value="someRubbishThatIsntASchema" />
		</bean>
	</beans>


	<!-- Test that exception is thrown for bad template. -->
	<beans profile="badTemplate">
		<bean id="test2" class="java.nio.file.Paths" factory-method="get">
			<constructor-arg index="0">
				<value type="java.lang.String">webapps/test2</value>
			</constructor-arg>
			<constructor-arg index="1">
				<list></list>
			</constructor-arg>
		</bean>
		
		<bean id="bad-template-factory" class="gov.hawaii.digitalarchives.hida.persistentid.Hark$HarkFactory$ArkFactory" >
			<constructor-arg type="java.lang.String" value=".,;'4w" />
			<constructor-arg type="java.lang.String" value="70111" />
			<constructor-arg type="java.nio.file.Path" ref="test2" />
		</bean>
	</beans>
	

	<!-- Test ID generation limit -->
	<beans profile="limitedId">
		<bean id="test1" class="java.nio.file.Paths" factory-method="get">
			<constructor-arg index="0">
				<value type="java.lang.String">webapps/test1</value>
			</constructor-arg>
			<constructor-arg index="1">
				<list></list>
			</constructor-arg>
		</bean>
		
		<bean id="limited-decimal-template" class="gov.hawaii.digitalarchives.hida.persistentid.Hark$HarkFactory$ArkFactory">
			<constructor-arg type="java.lang.String" value=".sd" />
			<constructor-arg type="java.lang.String" value="70111" />
			<constructor-arg type="java.nio.file.Path" ref="test1" />
		</bean>
	</beans>
	
</beans>
